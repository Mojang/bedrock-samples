{
  "namespace": "gift_promo",

  "colored_direction_button_panel": {
    "type": "panel",
    "$direction_gamepad_button_helper|default": "gamepad_helper@common.gamepad_helper_right_bumper",
    "controls": [
      {
        "chevron_image@common.chevron_image": {
          "color": "$text_color",
          "bindings": [
            {
              "binding_name": "(not #is_using_gamepad)",
              "binding_name_override": "#visible"
            }
          ]
        }
      },
      {
        "$direction_gamepad_button_helper": {
          "offset": [ 0, 4 ],
          "anchor_from": "center",
          "anchor_to": "center",
          "$hide_description|default": true,
          "$gamepad_helper_icon_size|default": [ 18, 18 ]
        }
      }
    ]
  },

  "timer_icon_tooltip_panel": {
    "type": "panel",
    "size": [ 8, 8 ],
    "layer": 10,
    "controls": [
      {
        "limited_status_image": {
          "type": "image",
          "size": [ "100%", "100%" ],
          "offset": [ 0, -1 ],
          "bilinear": true,
          "texture": "textures/ui/timer",
          "layer": 1
        }
      }
    ]
  },

  "timer_tooltip_panel@common.button": {
    "size": [ 8, 8 ],
    "sound_volume": 0.0,

    "$tooltip_button_content_size|default": [ "100%", "100%" ],
    "$tooltip_panel_offset": [ -11, 8 ],
    "$tooltip_background_texture": "textures/ui/tooltip_default_background",
    "$tooltip_chevron_anchor": "top_left",
    "$tooltip_popup_chevron_offset": [ 2, "-100%y + 4px" ],
    "$tooltip_popup_chevron_texture": "textures/ui/tooltip_inverted_chevron",

    "$pressed_button_name": "button.ignore_me",
    "$tooltip_button_collection_name": "",

    "$tooltip_button_binding_type": "none",
    "$tooltip_text_binding_name": "store.promo.tooltip",
    "$tooltip_text_font_type": "smooth",
    "$tooltip_text_font_scale": 0.8,
    "$tooltip_popup_override_image_panel": "gift_promo.timer_icon_tooltip_panel",
    "$override_tooltip_popup_image": true,

    "button_mappings": [
      {
        "from_button_id": "button.menu_select",
        "to_button_id": "$pressed_button_name",
        "mapping_type": "pressed"
      },
      {
        "from_button_id": "button.menu_ok",
        "to_button_id": "$pressed_button_name",
        "mapping_type": "focused"
      }
    ],

    "controls": [
      {
        "default@common.empty_panel": {}
      },
      {
        "hover@common.dynamic_tooltip_popup_with_image_and_text": {
          "anchor_to": "top_left",
          "anchor_from": "bottom_middle"
        }
      },
      {
        "pressed@common.dynamic_tooltip_popup_with_image_and_text": {
          "anchor_to": "top_left",
          "anchor_from": "bottom_middle"
        }
      }
    ],
    "bindings": [
      {
        "binding_name": "#price_info_visible",
        "binding_name_override": "#visible"
      }
    ]
  },

  "promotion_item_description": {
    "type": "label",
    "size": [ "100%", "default" ],
    "font_type": "smooth",
    "font_scale_factor": 0.8,
    "text": "#item_description_text",
    "color": "$body_text_color",
    "bindings": [
      {
        "binding_name": "#item_description_text"
      },
      {
        "binding_type": "global",
        "binding_name": "#item_description_color",
        "binding_name_override": "#color"
      }
    ]
  },

  "promotion_item_text_panel": {
    "type": "stack_panel",
    "orientation": "vertical",
    "size": [ "100%", "fill" ],
    "controls": [
      {
        "title@common.minecraftTenLabel": {
          "size": [ "default", "default" ],
          "color": "$body_text_color",
          "text": "#item_title_text",
          "bindings": [
            {
              "binding_name": "#item_title_text"
            }
          ]
        }
      },
      {
        "timer_panel": {
          "type": "stack_panel",
          "orientation": "horizontal",
          "size": [ "100%", "100%cm" ],
          "controls": [
            {
              "timer_icon_and_tooltip_panel": {
                "type": "panel",
                "size": [ 12, 8 ],
                "bindings": [
                  {
                    "binding_name": "#item_timer_visible",
                    "binding_name_override": "#visible"
                  }
                ],
                "controls": [
                  {
                    "tooltip_button@gift_promo.timer_tooltip_panel": {}
                  },
                  {
                    "timer_icon": {
                      "type": "image",
                      "size": [ 8, 8 ],
                      "offset": [ 0, 1 ],
                      "bilinear": true,
                      "texture": "textures/ui/timer"
                    }
                  }
                ]
              }
            },
            {
              "timer_text": {
                "type": "label",
                "size": [ "100%", "default" ],
                "font_type": "smooth",
                "font_scale_factor": 0.8,
                "color": "$coin_color",
                "text": "#item_timer_text",
                "bindings": [
                  {
                    "binding_name": "#item_timer_text"
                  }
                ]
              }
            }
          ]
        }
      },
      {
        "creator_panel": {
          "type": "panel",
          "size": [ "100%", 12 ],
          "controls": [
            {
              "creator@common.single_line_label": {
                "size": [ "100%c", "100%" ],
                "offset": [ 0, -1 ],
                "anchor_from": "left_middle",
                "anchor_to": "left_middle",
                "$single_line_label_text": "#item_creator_text",
                "$single_label_size": [ "default", 8 ],
                "$single_line_font_scale_factor": 0.8,
                "$label_text_bindings": [
                  {
                    "binding_name": "#item_creator_text"
                  }
                ],
                "bindings": [
                  {
                    "binding_name": "#item_is_world",
                    "binding_name_override": "#visible"
                  }
                ]
              }
            }
          ]
        }
      },
      {
        "world": {
          "type": "stack_panel",
          "orientation": "horizontal",
          "size": [ "100%", "100%cm" ],
          "bindings": [
            {
              "binding_name": "#item_is_world",
              "binding_name_override": "#visible"
            }
          ],
          "controls": [
            {
              "icon": {
                "type": "image",
                "size": [ 8, 8 ],
                "texture": "textures/ui/glyph_world_template",
                "color": "$body_text_color"
              }
            },
            {
              "pad": {
                "type": "panel",
                "size": [ 2, 10 ]
              }
            },
            {
              "text": {
                "type": "label",
                "size": [ "100%", "default" ],
                "font_type": "smooth",
                "font_scale_factor": 0.8,
                "color": "$body_text_color",
                "text": "store.mashup.count.world"
              }
            }
          ]
        }
      },
      {
        "description@common.scrolling_panel_with_offset": {
          "size": [ "100% - 8px", "fill" ],
          "$scrolling_content": "gift_promo.promotion_item_description",
          "$scroll_background_image_control": "common.empty_panel"
        }
      }
    ]
  },

  "promo_item_pdp_button@common.minecraftTenLabel": {
    "size": [ "default", "default" ],
    "offset": [ 0, -1],
    "text": "#pdp_button_text",
    "color": "$text_color",
    "bindings": [
      {
        "binding_name": "#pdp_button_text"
      }
    ]
  },

  "free_discount_label": {
    "type": "label",
    "size": [ "default", 10 ],
    "font_type": "smooth",
    "text": "storageManager.share.totalPercent",
    "color": "$store_sales_banner_text_color",
    "layer": 10
  },

  "promo_item_action_button": {
    "type": "panel",
    "size": [ "100%", "100%" ],
    "controls": [
      {
        "markdown": {
          "type": "stack_panel",
          "orientation": "horizontal",
          "size": [ "100%c", "100%" ],
          "anchor_to": "left_middle",
          "anchor_from": "left_middle",
          "bindings": [
            {
              "binding_name": "#item_is_not_owned",
              "binding_name_override": "#visible"
            }
          ],
          "controls": [
            {
              "sales_banner_offset_panel": {
                "priority": 0,
                "type": "panel",
                "size": [ "100%c", "100%" ],
                "controls": [
                  {
                    "sales_banner_panel": {
                      "type": "panel",
                      "size": [ "100%c", "100% + 4px" ],
                      "offset": [ -2, 0 ],
                      "anchor_from": "left_middle",
                      "anchor_to": "left_middle",
                      "controls": [
                        {
                          "markdown_banner@common_store.markdown_background": {
                            "$markdown_label": "gift_promo.free_discount_label",
                            "size": [ "100%c", "100%" ],
                            "$banner_size": [ "20px", "100%" ],
                            "$triangle_offset": [ 0, 0 ],
                            "layer": 9,
                            "$triangle_texture": "textures/ui/saleflagtrianglebeveldefault",
                            "$banner_texture": "textures/ui/sale_button_borderless_lighthoverflag"
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            },
            {
              "price_markdown_panel": {
                "type": "panel",
                "size": [ "100%c", "100%" ],
                "controls": [
                  {
                    "offer_price": {
                      "type": "label",
                      "size": [ "default", 10 ],
                      "layer": 4,
                      "color": "$text_color",
                      "text": "#item_full_price",
                      "font_type": "smooth",
                      "bindings": [
                        {
                          "binding_name": "#item_full_price"
                        }
                      ],
                      "controls": [
                        {
                          "text_strike_through@common_store.text_strike_through": {
                            "size": [ "100% + 2px", 1 ],
                            "offset": [ 0, 1 ],
                            "color": "$text_color",
                            "alpha": 0.6,
                            "layer": 5
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      {
        "promo_item_action_text@common.minecraftTenLabel": {
          "size": [ "default", "default" ],
          "offset": [ 0, -1 ],
          "text": "#item_action_button_text",
          "color": "$text_color",
          "bindings": [
            {
              "binding_name": "#item_action_button_text"
            }
          ]
        }
      }
    ]
  },

  "promotion_item_buttons_panel": {
    "type": "stack_panel",
    "orientation": "vertical",
    "size": [ "100%", "100%c" ],
    "controls": [
      {
        "top_button@common_buttons.light_content_button": {
          "type": "button",
          "size": [ "100% - 8px", 22 ],
          "$pressed_button_name": "button.item_action",
          "$button_content": "gift_promo.promo_item_action_button",
          "$markdown_size": [ "100% + 2px", "100% + 4px" ],
          "$is_purchase_button": true,
          "$ignore_markdown_filler_panel": "#is_on_sale",
          "bindings": [
            {
              "binding_name": "#action_button_visible",
              "binding_name_override": "#visible"
            }
          ]
        }

      },
      {
        "pad": {
          "type": "panel",
          "size": [ "100%", 2 ]
        }
      },
      {
        "bottom_button@common_buttons.light_content_button": {
          "size": [ "100% - 8px", 22 ],
          "$pressed_button_name": "button.item_pdp",
          "$button_content": "gift_promo.promo_item_pdp_button"
        }
      }
    ]
  },

  "promotion_top_left_panel": {
    "type": "panel",
    "size": [ "50%", "100%" ],
    "layer": 6,
    "controls": [
      {
        "promotion_top_left_stack": {
          "type": "stack_panel",
          "orientation": "vertical",
          "size": [ "100%", "100% - 8px" ],
          "offset": [ 5, -2 ],
          "controls": [
            {
              "top_text_panel@gift_promo.promotion_item_text_panel": {}
            },
            {
              "bottom_button_panel@gift_promo.promotion_item_buttons_panel": {}
            }
          ]
        }
      }
    ]
  },

  "grey_bar_panel": {
    "type": "stack_panel",
    "orientation": "horizontal",
    "size": [ "fill", "100%" ],
    "controls": [
      {
        "grey_bar": {
          "type": "image",
          "size": [ "100% - 1px", "100%" ],
          "texture": "textures/ui/white_background",
          "keep_ratio": false,
          "tiled": true,
          "color": "$servers_screenshot",
          "bindings": [
            {
              "binding_name": "(not #this_screenshot_selected)",
              "binding_name_override": "#visible",
              "binding_type": "collection",
              "binding_collection_name": "world_screenshot_collection"
            }
          ]
        }
      },
      {
        "green_bar": {
          "type": "image",
          "size": [ "100% - 1px", "100%" ],
          "texture": "textures/ui/white_background",
          "keep_ratio": false,
          "tiled": true,
          "color": "$servers_current_screenshot",
          "bindings": [
            {
              "binding_name": "#this_screenshot_selected",
              "binding_name_override": "#visible",
              "binding_type": "collection",
              "binding_collection_name": "world_screenshot_collection"
            }
          ]
        }
      },
      {
        "padding": {
          "type": "panel",
          "size": [ 1, "100%" ]
        }
      }
    ]
  },

  "promotion_screenshots_section_panel": {
    "type": "stack_panel",
    "orientation": "vertical",
    "size": [ "75%", "100%c" ],
    "controls": [
      {
        "screenshots_panel": {
          "type": "panel",
          "size": [ "100%", "56.25%x" ],
          "controls": [
            {
              "screen_shot_loading@common_store.progress_loading": {
                "layer": 100, // Make this on top
                "$hide_failure_text": true,
                "$hide_progress_loading_outline": true,
                "$source_control_name": "active_screenshot_image",
                "$source_property_name": "(#texture = '')"
              }
            },
            {
              "active_screenshot_image": {
                "type": "image",
                "bindings": [
                  {
                    "binding_name": "(not #screenshot_texture = '')",
                    "binding_name_override": "#visible"
                  },
                  {
                    "binding_name": "#screenshot_texture",
                    "binding_name_override": "#texture"
                  },
                  {
                    "binding_name": "#screenshot_location",
                    "binding_name_override": "#texture_file_system"
                  },
                  {
                    "binding_name": "#screenshot_location",
                    "binding_type": "collection",
                    "binding_name_override": "#texture_file_system",
                    "binding_collection_name": "gift_promotion_collection"
                  }
                ],
                "controls": [
                  {
                    "key_art_frame@common.square_image_border_white": {
                      "size": [ "100% + 2px", "100% + 2px" ],
                      "color": "$0_color_format",
                      "layer": 5
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      {
        "pad": {
          "type": "panel",
          "size": [ "100%", 4 ]
        }
      },
      {
        "navigation_panel": {
          "type": "stack_panel",
          "orientation": "horizontal",
          "size": [ "100%", 15 ],
          "controls": [
            {
              "left_arrow_button@common_buttons.light_content_button": {
                "$pressed_button_name": "button.navigate_screenshots_left",
                "$button_content": "play.left_arrow_icon",
                "$focus_override_right": "right_arrow_button",
                "$focus_override_left": "left_panel",
                "size": [ 15, "100%" ]
              }
            },
            {
              "padding_0": {
                "type": "panel",
                "size": [ 4, "100%" ]
              }
            },
            {
              "navigation_bar": {
                "type": "panel",
                "size": [ "fill", 5 ],
                "controls": [
                  {
                    "grey_bar": {
                      "type": "image",
                      "size": [ "100%", "100%" ],
                      "offset": [ 0, 5 ],
                      "texture": "textures/ui/Black",
                      "layer": 1,
                      "controls": [
                        {
                          "grey_bar_factory_panel": {
                            "type": "stack_panel",
                            "orientation": "horizontal",
                            "size": [ "100% - 1px", 3 ],
                            "anchor_from": "right_middle",
                            "anchor_to": "right_middle",
                            "layer": 2,
                            "factory": {
                              "name": "grey_bar_factory",
                              "control_name": "gift_promo.grey_bar_panel"
                            },
                            "collection_name": "world_screenshot_collection",
                            "bindings": [
                              {
                                "binding_name": "#screenshot_collection_length",
                                "binding_name_override": "#collection_length"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            },
            {
              "padding_1": {
                "type": "panel",
                "size": [ 4, "100%" ]
              }
            },
            {
              "right_arrow_button@common_buttons.light_content_button": {
                "$pressed_button_name": "button.navigate_screenshots_right",
                "$button_content": "play.right_arrow_icon",
                "$focus_id": "right_arrow_button",
                "size": [ 15, "100%" ]
              }
            }
          ]
        }
      }
    ]
  },

  "progress_loading": {
    "type": "panel",
    "size": [ "100%", "100%" ],
    "$baseLayer|default": 2,
    "controls": [
      {
        "progress_loading_outline@common_store.banner_fill": {
          "size": [ "60%", "20%x" ],
          "visible": "(not $hide_progress_loading_outline)",
          "controls": [
            {
              "progress_loading_spinner@common_store.progress_loading_spinner": {
                "layer": "($baseLayer + 1)"
              }
            }
          ]
        }
      }
    ]
  },

  "progress_loading_input_panel": {
    "type": "input_panel",
    "size": [ "100%sm - 2px", "100%sm" ],
    "layer": 200,

    "bindings": [
      {
        "binding_name": "#character_loading_in_progress",
        "binding_name_override": "#visible"
      }
    ],
    "controls": [
      {
        "progress_loading@gift_promo.progress_loading": {
          "size": [ "100% - 2px", "100% - 2px" ],
          "$hide_failure_text": true,
          "$hide_progress_loading_outline": false,
          "bindings": []
        }
      }
    ]
  },

  "promotion_skin_viewer_panel": {
    "type": "input_panel",
    "layer": 5,
    "gesture_tracking_button": "button.turn_doll",
    "bindings": [
      {
        "binding_name": "#can_paperdoll_rotate",
        "binding_name_override": "#always_handle_controller_direction",
        "binding_condition": "always"
      }
    ],
    "button_mappings": [
      {
        "from_button_id": "button.menu_select",
        "to_button_id": "button.turn_doll",
        "mapping_type": "pressed",
        "button_up_right_of_first_refusal": true
      }
    ],
    "controls": [
      {
        "popup_dialog_factory": {
          "type": "factory",
          "control_ids": {
            "toast_message": "@persona.popup_toast"
          }
        }
      },
      {
        "character_loading_panel@gift_promo.progress_loading_input_panel": {}
      },
      {
        "skin_model_panel": {
          "type": "panel",
          "size": [ "100%", "100%" ],
          "offset": [ 0, -30 ],
          "$input_progress_loading_binding_name": "#character_loading_in_progress",
          "controls": [
            {
              "skin_model": {
                "type": "custom",
                "renderer": "paper_doll_renderer",
                "camera_tilt_degrees": -10,
                "starting_rotation": 30,
                "layer": 5,
                "use_selected_skin": false,
                "use_skin_gui_scale": true,
                "rotation": "gesture_x",
                "animation_reset_name": "screen_animation_reset",
                "anims": [
                  "@common.screen_exit_size_animation_push",
                  "@common.screen_exit_size_animation_pop",
                  "@common.screen_entrance_size_animation_push",
                  "@common.screen_entrance_size_animation_pop"
                ],
                "bindings": [
                  {
                    "binding_type": "global",
                    "binding_name": "$skin_preview"
                  },
                  {
                    "binding_type": "view",
                    "source_control_name": "$gesture_input_panel_control",
                    "source_property_name": "#gesture_delta_source",
                    "target_property_name": "#gesture_delta_source"
                  },
                  {
                    "binding_type": "view",
                    "source_control_name": "$gesture_input_panel_control",
                    "source_property_name": "#gesture_mouse_delta_x",
                    "target_property_name": "#gesture_mouse_delta_x"
                  }
                ]
              }
            }
          ]
        }
      },
      {
        "arrow_panel": {
          "type": "panel",
          "size": [ "100%", 22 ],
          "anchor_from": "bottom_middle",
          "anchor_to": "bottom_middle",
          "bindings": [
            {
              "binding_name": "(not #preview_appearance_on)",
              "binding_name_override": "#visible"
            }
          ],
          "controls": [
            {
              "rotate_arrows@skin_picker.skin_rotation_arrows": {
                "size": [ 37, 7 ],
                "anchor_from": "bottom_middle",
                "anchor_to": "bottom_middle"
              }
            }
          ]
        }
      }
    ]
  },

  "promotion_top_main_panel": {
    "type": "image",
    "size": [ "85% + 8px", "90%" ],
    "texture": "textures/ui/promo_background",
    "layer": 2,
    "controls": [
      {
        "stack_panel": {
          "type": "stack_panel",
          "orientation": "horizontal",
          "size": [ "100%", "100%" ],
          "controls": [
            {
              "left_side@gift_promo.promotion_top_left_panel": {}
            },
            {
              "right_side": {
                "type": "panel",
                "size": [ "50%", "100%" ],
                "layer": 3,
                "controls": [
                  {
                    "persona_preview@gift_promo.promotion_skin_viewer_panel": {
                      "size": [ "100% - 8px", "100% - 8px" ],
                      "$gesture_input_panel_control": "persona_preview",
                      "$skin_preview": "#preview_persona_item",
                      "bindings": [
                        {
                          "binding_name": "(not #item_is_world)",
                          "binding_name_override": "#visible"
                        }
                      ]
                    }
                  },
                  {
                    "world_screenshots@gift_promo.promotion_screenshots_section_panel": {
                      "bindings": [
                        {
                          "binding_name": "#item_is_world",
                          "binding_name_override": "#visible"
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  },

  "promotion_screen_top": {
    "type": "panel",
    "size": [ "100%", "fill" ],
    "controls": [
      {
        "main_panel@gift_promo.promotion_top_main_panel": {}
      },
      {
        "left_corner_art": {
          "type": "image",
          "size": [ 128, 124 ],
          "offset": [ 1, 0 ],
          "anchor_from": "top_left",
          "anchor_to": "top_left",
          "texture": "textures/ui/bubbles_left_corner",
          "layer": 1
        }
      },
      {
        "right_corner_art": {
          "type": "image",
          "size": [ 128, 124 ],
          "offset": [ -1, 0 ],
          "anchor_from": "top_right",
          "anchor_to": "top_right",
          "texture": "textures/ui/bubbles_right_corner",
          "layer": 1
        }
      }
    ]
  },

  "promotion_screen_panel": {
    "type": "panel",
    "controls": [
      {
        "progress_loading@common_store.progress_loading": {
          "layer": 100, // Make this on top
          "bindings": [
            {
              "binding_name": "#page_loading_visible",
              "binding_name_override": "#visible",
              "binding_condition": "always"
            }
          ]
        }
      },
      {
        "promotion_screen_content": {
          "type": "stack_panel",
          "orientation": "vertical",
          "size": [ "100%", "100%" ],
          "bindings": [
            {
              "binding_type": "view",
              "source_control_name": "progress_loading",
              "source_property_name": "(not #visible)",
              "target_property_name": "#visible",
              "resolve_sibling_scope": true
            }
          ],
          "controls": [
            {
              "top_half@gift_promo.promotion_screen_top": {}
            },
            {
              "bottom_half_panel": {
                "type": "panel",
                "size": [ "100%", "100%c" ],
                "controls": [
                  {
                    "bottom_half": {
                      "type": "image",
                      "size": [ "100% - 2px", "100%cm + 6px" ],
                      "texture": "textures/ui/promo_background",
                      "anchor_from": "bottom_middle",
                      "anchor_to": "bottom_middle",
                      "offset": [ 0, -2 ],
                      "layer": 2,
                      "controls": [
                        {
                          "carousel_panel": {
                            "type": "panel",
                            "size": [ "100% - 1px", "100%cm" ],
                            "layer": 3,

                            "$ignore_cycle_buttons": false,

                            "controls": [
                              {
                                "left_button_panel": {
                                  "type": "panel",
                                  "size": [ "100%c", "100%sm" ],
                                  "offset": [ 3, 0 ],
                                  "anchor_from": "left_middle",
                                  "anchor_to": "left_middle",
                                  "controls": [
                                    {
                                      "left_button@common_store.cycle_pack_left_button": {
                                        "$pressed_button_name": "button.cycle_promotions_left",
                                        "$cycle_pack_button_name_left": "button.cycle_promotions_left",
                                        "$button_content": "gift_promo.colored_direction_button_panel",
                                        "size": [ 20, "100%" ],
                                        "bindings": [
                                          {
                                            "binding_name": "#cycle_promotions_left_button_enabled",
                                            "binding_name_override": "#enabled"
                                          },
                                          {
                                            "binding_name": "(not #is_using_gamepad)",
                                            "binding_name_override": "#focus_enabled"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                }
                              },
                              {
                                "offer_grid@gift_promo.promotion_content_offer_panel": {}
                              },
                              {
                                "right_button_panel": {
                                  "type": "panel",
                                  "size": [ "100%c", "100%sm" ],
                                  "offset": [ -1, 0 ],
                                  "anchor_from": "right_middle",
                                  "anchor_to": "right_middle",
                                  "controls": [
                                    {
                                      "right_button@common_store.cycle_pack_right_button": {
                                        "$pressed_button_name": "button.cycle_promotions_right",
                                        "$cycle_pack_button_name_right": "button.cycle_promotions_right",
                                        "$button_content": "gift_promo.colored_direction_button_panel",
                                        "size": [ 20, "100%" ],
                                        "bindings": [
                                          {
                                            "binding_name": "#cycle_promotions_right_button_enabled",
                                            "binding_name_override": "#enabled"
                                          },
                                          {
                                            "binding_name": "(not #is_using_gamepad)",
                                            "binding_name_override": "#focus_enabled"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                }
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  },

  "promotion_content": {
    "type": "panel",
    "controls": [
      {
        "header@common_store.store_header_with_coins": {
          "$child_control": "gift_promo.promotion_screen_panel",
          "$button_text": "store.promo.title",
          "$back_button_has_title": true,
          "$back_button_pressed_button_name": "button.exit_gift_screen"
        }
      },
      {
        "holiday_promo_screen_panel": {
          "type": "factory",
          "size": [ 0, 0 ],
          "control_ids": {
            "no_store_connection": "@common_store.popup_dialog__no_store_connection",
            "restore_popup": "@common_store.popup_dialog__restore_popup",
            "restore_failed": "@common_store.popup_dialog__restore_failed"
          }
        }
      }
    ]
  },

  "store_promotion_screen@common_store.store_base_screen": {
    "$screen_content": "gift_promo.promotion_content",
    "$screen_header_title_visible": false,
    "$header_safezone_control": "common_store.store_top_bar_filler",
    "$header_bar_control": "common_store.store_top_bar",
    "$screen_background_control": "common_store.store_background",
    "$is_full_screen_layout": true,
    "$fill_alpha": 0.75,
    "size": [ "100%", "100%" ],
    "button_mappings": [
      {
        "from_button_id": "button.menu_cancel",
        "to_button_id": "button.exit_gift_screen",
        "mapping_type": "global"
      },
      {
        "from_button_id": "button.menu_secondary_select",
        "to_button_id": "button.exit_gift_screen",
        "mapping_type": "pressed"
      },
      {
        "from_button_id": "button.controller_select",
        "to_button_id": "button.coin_wallet",
        "mapping_type": "global"
      },
      {
        "from_button_id": "button.menu_tab_right",
        "to_button_id": "button.cycle_promotions_right",
        "mapping_type": "global"
      },
      {
        "from_button_id": "button.menu_tab_left",
        "to_button_id": "button.cycle_promotions_left",
        "mapping_type": "global"
      }
    ]
  },

  //--------------------------------------------------------------------------------
  // Content offer carousel
  //--------------------------------------------------------------------------------

  "promotion_persona_and_world_panel": {
    "type": "panel",
    "size": [ "31% - 7px", "100%c" ],
    "controls": [
      {
        "promotion_persona_and_world_item": {
          "type": "image",
          "texture": "textures/ui/Grey",
          "size": [ "100% - 1px", "100%c + 3px" ],
          "alpha": 0.4,
          "layer": 1,
          "controls": [
            {
              "promotion_persona_and_world_panel": {
                "type": "stack_panel",
                "orientation": "vertical",
                "size": [ "100%", "100%c + 2px" ],
                "offset": [ 0, 2 ],
                "layer": 2,
                "controls": [
                  {
                    "day_label_panel": {
                      "type": "panel",
                      "size": [ "100%", "100%c - 2px" ],
                      "controls": [
                        {
                          "day_label@common.minecraftTenLabel": {
                            "size": [ "default", "default" ],
                            "color": "$body_text_color",
                            "text": "#day_four_string",
                            "anchor_from": "top_middle",
                            "anchor_to": "top_middle",
                            "offset": [ 0, -2 ],
                            "bindings": [
                              {
                                "binding_name": "#day_four_string"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "pad": {
                      "type": "panel",
                      "size": [ "100%", 2 ]
                    }
                  },
                  {
                    "item_buttons": {
                      "type": "stack_panel",
                      "orientation": "horizontal",
                      "size": [ "100% - 2px", "40%x - 2px" ],
                      "collection_name": "gift_promotion_collection",
                      "controls": [
                        {
                          "persona_item@gift_promo.promotion_offer_grid_item": {
                            "$item_size": [ "38%", "100%" ],
                            "collection_index": 3,
                            //Doesn't cover text above this control. This will be completely removed when porting to SDL
                            "bindings": [
                              {
                                "binding_type": "collection_details",
                                "binding_collection_name": "gift_promotion_collection"
                              },
                              {
                                "binding_name": "#is_valid",
                                "binding_name_override": "#visible",
                                "binding_type": "collection",
                                "binding_collection_name": "gift_promotion_collection"
                              }
                            ]
                          }
                        },
                        {
                          "world_item@gift_promo.promotion_offer_grid_item": {
                            "$item_size": [ "62%", "100%" ],
                            "collection_index": 4,
                            "$is_world_item": true,
                            //Doesn't cover text above this control. This will be completely removed when porting to SDL
                            "bindings": [
                              {
                                "binding_type": "collection_details",
                                "binding_collection_name": "gift_promotion_collection"
                              },
                              {
                                "binding_name": "#is_valid",
                                "binding_name_override": "#visible",
                                "binding_type": "collection",
                                "binding_collection_name": "gift_promotion_collection"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  },

  "promotion_offer_grid_panel": {
    "type": "panel",
    "size": [ "11.5%", "100%c" ],
    "bindings": [
      {
        "binding_type": "collection_details",
        "binding_collection_name": "gift_promotion_collection"
      },
      {
        "binding_name": "#is_valid",
        "binding_name_override": "#visible",
        "binding_type": "collection",
        "binding_collection_name": "gift_promotion_collection"
      }
    ],
    "controls": [
      {
        "promotion_offer_grid_image": {
          "type": "image",
          "texture": "textures/ui/Grey",
          "size": [ "100% - 1px", "100%c + 2px" ],
          "alpha": 0.4,
          "layer": 1,
          "controls": [
            {
              "promotion_offer_grid_stack_panel": {
                "type": "stack_panel",
                "orientation": "vertical",
                "size": [ "100%", "100%c + 2px" ],
                "offset": [ 0, 2 ],
                "layer": 2,
                "controls": [
                  {
                    "day_label_panel": {
                      "type": "panel",
                      "size": [ "100%", "100%c" ],
                      "controls": [
                        {
                          "day_label@common.minecraftTenLabel": {
                            "size": [ "default", "default" ],
                            "color": "$body_text_color",
                            "text": "#promotion_day_text",
                            "anchor_from": "top_middle",
                            "anchor_to": "top_middle",
                            "offset": [ 0, -2 ],
                            "bindings": [
                              {
                                "binding_type": "collection_details",
                                "binding_collection_name": "gift_promotion_collection"
                              },
                              {
                                "binding_name": "#promotion_day_text",
                                "binding_type": "collection",
                                "binding_collection_name": "gift_promotion_collection"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "pad": {
                      "type": "panel",
                      "size": [ "100%", 2 ]
                    }
                  },
                  {
                    "image_panel": {
                      "type": "panel",
                      "size": [ "100% - 2px", "100%x" ],
                      "controls": [
                        {
                          "item_button@gift_promo.promotion_offer_grid_item": {}
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  },

  "promotion_content_offer_panel": {
    "type": "stack_panel",
    "orientation": "horizontal",
    "size": [ "100% - 46px", "100%cm" ],
    "offset": [ 1, 0 ],
    "collection_name": "gift_promotion_collection",
    "controls": [
      {
        "offer_item_1@gift_promo.promotion_offer_grid_panel": {
          "collection_index": 0,
          "$focus_override_left": "FOCUS_OVERRIDE_STOP"
        }
      },
      {
        "padding_0": {
          "type": "panel",
          "size": [ 1, "100%sm" ]
        }
      },
      {
        "offer_item_2@gift_promo.promotion_offer_grid_panel": {
          "collection_index": 1
        }
      },
      {
        "padding_1": {
          "type": "panel",
          "size": [ 1, "100%sm" ]
        }
      },
      {
        "offer_item_3@gift_promo.promotion_offer_grid_panel": {
          "collection_index": 2
        }
      },
      {
        "padding_2": {
          "type": "panel",
          "size": [ 1, "100%sm" ]
        }
      },
      {
        "offer_item_4@gift_promo.promotion_persona_and_world_panel": {
          //Collection indices 3 and 4 are in promotion_persona_and_world_panel
        }
      },
      {
        "padding_3": {
          "type": "panel",
          "size": [ 1, "100%sm" ]
        }
      },
      {
        "offer_item_5@gift_promo.promotion_offer_grid_panel": {
          "collection_index": 5
        }
      },
      {
        "padding_4": {
          "type": "panel",
          "size": [ 1, "100%sm" ]
        }
      },
      {
        "offer_item_6@gift_promo.promotion_offer_grid_panel": {
          "collection_index": 6
        }
      },
      {
        "padding_5": {
          "type": "panel",
          "size": [ 1, "100%sm" ]
        }
      },
      {
        "offer_item_7@gift_promo.promotion_offer_grid_panel": {
          "collection_index": 7,
          "$focus_override_right": "FOCUS_OVERRIDE_STOP"
        }
      }
    ]
  },

  //--------------------------------------------------------------------------------
  // Store offer carousel
  //--------------------------------------------------------------------------------

  "promotion_offer_grid_item": {
    "type": "panel",
    "$item_size|default": [ "100%", "100%" ],
    "size": "$item_size",
    "offset": [ 1, -1 ],

    "$is_world_item|default": false,

    "variables": [
      {
        "requires": "$is_world_item",
        "$size": [ "100%", "64.4%x" ],
        "$max_size": [ 90, 58 ]
      },
      {
        "requires": "(not $is_world_item)",
        "$size": [ "100% - 4px", "100%x" ],
        "$max_size": [ 58, 58 ]
      }
    ],
    "controls": [
      {
        "frame": {
          "type": "panel",
          "size": "$size",
          "max_size": "$max_size",
          "controls": [
            {
              "background@persona_common.item_rarity_color_background": {
                "size": [ "100%", "100%" ],
                "ignored": "$is_world_item",
                "$rarity_background_alpha": 1,
                "$rarity_color_background_texture": "textures/ui/button_borderless_light",
                "$rarity_binding_type": "collection",
                "$rarity_collection_name": "gift_promotion_collection",
                "layer": 1,
                "$rarity_background_bindings": [
                  {
                    "binding_name": "#promotion_offer_visible",
                    "binding_name_override": "#visible",
                    "binding_type": "collection",
                    "binding_collection_name": "gift_promotion_collection"
                  },
                  {
                    "binding_type": "$rarity_binding_type",
                    "binding_collection_name": "$rarity_collection_name",
                    "binding_name": "#rarity_color",
                    "binding_name_override": "#color"
                  }
                ]
              }
            },
            {
              "rarity_bar_panel@persona_common.rarity_bar": {
                "size": [ "100%", 3 ],
                "ignored": "$is_world_item",
                "$item_binding_type": "collection",
                "$item_collection_name": "gift_promotion_collection",
                "layer": 6,
                "bindings": [
                  {
                    "binding_type": "collection",
                    "binding_collection_name": "gift_promotion_collection",
                    "binding_name": "#rarity_bar_texture",
                    "binding_name_override": "#texture"
                  },
                  {
                    "binding_type": "collection",
                    "binding_collection_name": "gift_promotion_collection",
                    "binding_name": "#promotion_offer_visible",
                    "binding_name_override": "#visible"
                  }
                ]
              }
            },
            {
              "key_art_frame@common.square_image_border_white": {
                "size": [ "100%", "100%" ],
                "layer": 10,
                "bindings": [
                  {
                    "binding_name": "#this_promo_selected",
                    "binding_name_override": "#visible",
                    "binding_type": "collection",
                    "binding_collection_name": "gift_promotion_collection"
                  }
                ]
              }
            },
            {
              "green_check": {
                "type": "image",
                "size": [ 15, 12 ],
                "texture": "textures/ui/realms_green_check",
                "anchor_from": "bottom_right",
                "anchor_to": "bottom_right",
                "offset": [ -1, -1 ],
                "layer": 15,
                "bindings": [
                  {
                    "binding_name": "#item_has_been_claimed",
                    "binding_name_override": "#visible",
                    "binding_type": "collection",
                    "binding_collection_name": "gift_promotion_collection"
                  }
                ]
              }
            },
            {
              "key_art_image_panel": {
                "type": "panel",
                "size": [ "100% - 2px", "100% - 2px" ],
                "offset": [ 0, 1 ],
                "anchor_from": "top_middle",
                "anchor_to": "top_middle",
                "bindings": [
                  {
                    "binding_type": "collection",
                    "binding_collection_name": "gift_promotion_collection",
                    "binding_name": "#promotion_offer_visible",
                    "binding_name_override": "#visible"
                  }
                ],
                "controls": [
                  {
                    "image_loading_panel@common_store.progress_loading": {
                      "layer": 100, // Make this on top
                      "$hide_failure_text": true,
                      "$hide_progress_loading_outline": true,
                      "$source_control_name": "key_art_image",
                      "$source_property_name": "(#texture = '')"
                    }
                  },
                  {
                    "key_art_image": {
                      "type": "image",
                      "bilinear": true,
                      "max_size": "$max_size",
                      "layer": 4,
                      "bindings": [
                        {
                          "binding_type": "collection",
                          "binding_collection_name": "gift_promotion_collection",
                          "binding_name": "(not (#promotion_thumbnail_texture_path = ''))",
                          "binding_name_override": "#visible"
                        },
                        {
                          "binding_type": "collection",
                          "binding_collection_name": "gift_promotion_collection",
                          "binding_name": "#promotion_thumbnail_texture_path",
                          "binding_name_override": "#texture"
                        },
                        {
                          "binding_type": "collection",
                          "binding_collection_name": "gift_promotion_collection",
                          "binding_name": "#promotion_thumbnail_texture_file_system",
                          "binding_name_override": "#texture_file_system"
                        }
                      ]
                    }
                  }
                ]
              }
            },
            {
              "present_art": {
                "type": "image",
                "size": "$size",
                "max_size": "$max_size",
                "bindings": [
                  {
                    "binding_type": "view",
                    "source_control_name": "key_art_image_panel",
                    "source_property_name": "(not #visible)",
                    "target_property_name": "#visible",
                    "resolve_sibling_scope": true
                  },
                  {
                    "binding_name": "#promotion_offer_gift_image",
                    "binding_name_override": "#texture",
                    "binding_type": "collection",
                    "binding_collection_name": "gift_promotion_collection"
                  }
                ]
              }
            },
            {
              "offer_button@common.button": {
                "offset": [ 0, -1 ],
                "layer": 11,
                "default_control": "",
                "$pressed_button_name|default": "button.select_promotion_offer",
                "tts_inherit_siblings": true,
                "bindings": [
                  {
                    "binding_type": "collection_details",
                    "binding_collection_name": "gift_promotion_collection"
                  },
                  {
                    "binding_name": "#promotion_offer_visible",
                    "binding_name_override": "#enabled",
                    "binding_type": "collection",
                    "binding_collection_name": "gift_promotion_collection"
                  }
                ],
                "controls": [
                  {
                    "hover": {
                      "type": "panel",
                      "controls": [
                        {
                          "key_art_size_panel": {
                            "type": "panel",
                            "size": [ "100%", "100%" ],
                            "max_size": "$max_size",
                            "offset": [ 0, 1 ],
                            "anchor_from": "top_middle",
                            "anchor_to": "top_middle",
                            "layer": 1,
                            "controls": [
                              {
                                "key_art_frame@common.square_image_border_white": {
                                  "size": [ "100%", "100%" ],
                                  "layer": 2
                                }
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "pressed": {
                      "type": "panel",
                      "controls": [
                        {
                          "key_art_size_panel": {
                            "type": "panel",
                            "size": [ "100%", "100%" ],
                            "max_size": "$max_size",
                            "offset": [ 0, 1 ],
                            "anchor_from": "top_middle",
                            "anchor_to": "top_middle",
                            "layer": 1,
                            "controls": [
                              {
                                "key_art_frame@common.square_image_border_white": {
                                  "size": [ "100%", "100%" ],
                                  "layer": 2
                                }
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  }
}
